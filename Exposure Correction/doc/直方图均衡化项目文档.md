# ç›´æ–¹å›¾å‡è¡¡åŒ–é¡¹ç›®æ–‡æ¡£

[TOC]

------

## ç›´æ–¹å›¾å‡è¡¡åŒ–åŸºç¡€çŸ¥è¯†

### ç›´æ–¹å›¾

#### å®šä¹‰

ç»Ÿè®¡å›¾åƒä¸­æ¯ä¸ªåƒç´ çš„ä¸ªæ•°ï¼Œç”¨æ¨ªåæ ‡è¡¨ç¤ºå„ä¸ªåƒç´ å€¼ï¼Œçºµåæ ‡è¡¨ç¤ºå¯¹åº”åƒç´ å€¼çš„ä¸ªæ•°ï¼Œç»˜åˆ¶å¾—åˆ°çš„å›¾åƒå°±æ˜¯ç›´æ–¹å›¾ã€‚ä»ç›´æ–¹å›¾ä¸­æˆ‘ä»¬å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°å›¾åƒä¸­å„ä¸ªåƒç´ çš„åˆ†å¸ƒã€‚

#### æ€§è´¨

- ç›´æ–¹å›¾çš„åŠ¨æ€èŒƒå›´è¶Šå®½ï¼Œå›¾åƒçš„å¯¹æ¯”åº¦è¶Šå¤§

  > ä¾‹. ç¬¬ä¸€å¼ å›¾åƒçš„ç›´æ–¹å›¾èšé›†åœ¨ä¸­é—´çš„ä½ç½®ï¼Œè€Œç¬¬äºŒå¼ å›¾åƒçš„ç›´æ–¹å›¾åˆ†å¸ƒè¾ƒå®½ï¼›è€Œç¬¬ä¸€å¼ å›¾åƒç»™äººçš„è§†è§‰æ•ˆæœæ˜¯ç°è’™è’™çš„ï¼Œè€Œç¬¬äºŒå¼ å›¾åƒçš„å¯¹æ¯”åº¦æ›´å¤§ï¼Œè§†è§‰æ•ˆæœæ›´å¥½
  >
  > <img src="../../../../Library/Application Support/typora-user-images/image-20191109211824997.png" alt="image-20191109211824997" style="zoom:50%;" />
  >
  > <img src="../../../../Library/Application Support/typora-user-images/image-20191109211834897.png" alt="image-20191109211834897" style="zoom:50%;" />
  >
  > <img src="../../../../Library/Application Support/typora-user-images/image-20191109211800596.png" alt="image-20191109211800596" style="zoom:50%;" />
  >
  > <img src="../../../../Library/Application Support/typora-user-images/image-20191109211646864.png" alt="image-20191109211646864" style="zoom:50%;" />

- ç»™å®šå›¾åƒï¼Œç›´æ–¹å›¾æ˜¯å”¯ä¸€ç¡®å®šçš„

- ä½†æ˜¯ï¼Œç»™å®šç›´æ–¹å›¾ï¼Œå›¾åƒæ— æ³•ç¡®å®š

  > ğŸ”æƒ³æƒ³ä¸ºä»€ä¹ˆ
  >
  > ä¾‹å¦‚ï¼Œè¿™ä¸¤å¼ å›¾åƒçš„ç›´æ–¹å›¾éƒ½ä¸ºç¬¬ä¸‰å¼ å›¾ç‰‡æ‰€ç¤º
  >
  > <img src="../../../../Library/Application Support/typora-user-images/image-20191109211800596.png" alt="image-20191109211800596" style="zoom:50%;" />
  >
  > <img src="../../../../Library/Application Support/typora-user-images/image-20191109211710359.png" alt="image-20191109211710359" style="zoom:50%;" />
  >
  > <img src="../../../../Library/Application Support/typora-user-images/image-20191109211646864.png" alt="image-20191109211646864" style="zoom:50%;" />

#### è®¡ç®—æ–¹æ³•

ç»Ÿè®¡å›¾å½¢ä¸­å„ä¸ªåƒç´ çš„ä¸ªæ•°

ä¾‹å­.

<img src="../../../../Library/Application Support/typora-user-images/image-20191109211458421.png" alt="image-20191109211458421" style="zoom:50%;" />

### ç›´æ–¹å›¾å‡è¡¡åŒ–

å¯»æ‰¾ä¸€ä¸ªæ–¹æ³•ï¼ˆå…¶å®æœ¬è´¨æ˜¯ä½¿ç”¨ä¸€ä¸ªå‡½æ•°ï¼‰å°†å›¾åƒä¸­ä¸åŒåƒç´ ä¸ªæ•°å°½é‡å¹³å‡åŒ–ï¼Œä»¥è¾¾åˆ°æ›´å¥½çš„è§†è§‰æ•ˆæœã€‚

**å…¬å¼ï¼š**
$$
s = (L-1)\sum_{j=0}^{k}\frac{n_j}{M*N}
$$

- $L$: æ€»ç°åº¦çº§æ•°
- $M*N$: å›¾åƒå°ºå¯¸
- $n_j$: ç›´æ–¹å›¾ä¸­ç¬¬jé¡¹çš„å€¼

------

## ç›´æ–¹å›¾å‡è¡¡åŒ–ä»£ç å®ç°

### æ˜¾ç¤ºå›¾åƒç›´æ–¹å›¾

#### åº“å‡½æ•° --- plt.hist

ä½¿ç”¨pyplotçš„histæ–¹æ³•å¯ä»¥ç›´æ¥ç”Ÿæˆç›´æ–¹å›¾

```python
img_arr = img.flatten()	
n, bins, patches = plt.hist(img_arr, bins=256, facecolor='blue', alpha=0.75)
```

- **å‚æ•°ï¼š**
  - img_arr: éœ€è¦è®¡ç®—ç›´æ–¹å›¾çš„ä¸€ç»´æ•°ç»„
  - bins: ç›´æ–¹å›¾çš„æŸ±æ•°ï¼Œå¯é€‰é¡¹ï¼Œé»˜è®¤ä¸º10
  - normed: æ˜¯å¦å°†å¾—åˆ°çš„ç›´æ–¹å›¾å‘é‡å½’ä¸€åŒ–ã€‚é»˜è®¤ä¸º0
  - facecolor: ç›´æ–¹å›¾é¢œè‰²
  - alpha: é€æ˜åº¦
- **è¿”å›å€¼ï¼š**
  - n: ç›´æ–¹å›¾å‘é‡ï¼Œæ˜¯å¦å½’ä¸€åŒ–ç”±å‚æ•°è®¾å®š
  - bins: è¿”å›å„ä¸ªbinçš„åŒºé—´èŒƒå›´
  - patches: è¿”å›æ¯ä¸ªbiné‡Œé¢åŒ…å«çš„æ•°æ®ï¼Œæ˜¯ä¸€ä¸ªlist

**æ•ˆæœ**

<img src="../../../../Library/Application Support/typora-user-images/image-20191109221545222.png" alt="image-20191109221545222" style="zoom:50%;" />

#### åº“å‡½æ•° --- cv2.calcHist

```python
hist = cv2.calcHist([res],[0],None,[256],[0,255])
plt.plot(hist,'r')
plt.show()
```

<img src="https://img-blog.csdn.net/20180902112055224?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM3Mzg1NzI2/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="img" style="zoom:50%;" />

#### ç›´æ¥è®¡ç®—ç›´æ–¹å›¾

ç»Ÿè®¡å„ä¸ªåƒç´ çš„ä¸ªæ•°ï¼Œç»˜åˆ¶ä»¥åƒç´ ä¸ºæ¨ªè½´ï¼Œè¯¥åƒç´ æ•°é‡ä¸ºçºµè½´çš„å›¾åƒ

```python
def generate_histogram(img):
    '''
    @description: ç”¨å®šä¹‰æ³•ç”Ÿæˆå›¾åƒçš„ç›´æ–¹å›¾

    @params img: å›¾åƒï¼ˆäºŒç»´çŸ©é˜µï¼‰

    @return : null
    '''
    height, width = img.shape[:2]
    histogram = np.zeros([256])
    for i in range(height):
        for j in range(width):
            histogram[img[i][j]] += 1

    x = np.arange(256)
    plt.figure()
    plt.plot(x, histogram, 'r', linewidth=2, c='black')
    plt.show()
```

**æ•ˆæœ**

<img src="../../../../Library/Application Support/typora-user-images/image-20191109221529504.png" alt="image-20191109221529504" style="zoom:50%;" />

------

### ç›´æ–¹å›¾å‡è¡¡åŒ–

#### åº“å‡½æ•° --- cv2.equalizeHist

```python
img = cv2.imread('../../Resources/Histogram/origin.png', 0)
new_img = cv2.equalizeHist(img)
```

#### è‡ªå®šä¹‰ç®—æ³•

1. ä»¥ç°åº¦å›¾çš„æ–¹å¼åŠ è½½å›¾ç‰‡
2. æ±‚å‡ºåŸå›¾çš„ç°åº¦ç›´æ–¹å›¾ï¼Œè®¡ç®—æ¯ä¸ªç°åº¦çš„åƒç´ ä¸ªæ•°åœ¨æ•´ä¸ªå›¾åƒä¸­æ‰€å çš„ç™¾åˆ†æ¯”
3. è®¡ç®—å›¾åƒå„ç°åº¦çº§çš„ç´¯ç§¯æ¦‚ç‡å¯†åº¦åˆ†å¸ƒ
4. æ±‚å‡ºæ–°å›¾åƒçš„ç°åº¦å€¼ã€‚

```python
img = cv2.imread('../../Resources/Histogram/origin.png')
new_img = histeq(img)
```

```python
def histeq(img):
    '''
    @description: å¯¹å›¾åƒè¿›è¡Œç›´æ–¹å›¾å‡è¡¡åŒ–

    @params : å›¾åƒ

    @return : null
    '''
    histogram = get_histogram(img)

    pr = {}  # å»ºç«‹æ¦‚ç‡åˆ†å¸ƒæ˜ å°„è¡¨

    for i in histogram.keys():
        pr[i] = histogram[i] / (img.shape[0] * img.shape[1])

    tmp = 0
    for m in pr.keys():
        tmp += pr[m]
        pr[m] = max(histogram) * tmp

    new_img = np.zeros(shape=(img.shape[0], img.shape[1]), dtype=np.uint8)

    for k in range(img.shape[0]):
        for l in range(img.shape[1]):
            new_img[k][l] = pr[img[k][l][0]]

    return new_img
```

```python
def get_histogram(img):
    '''
    @description: è®¡ç®—å›¾åƒçš„ç›´æ–¹å›¾ä¿¡æ¯

    @params : å›¾åƒ

    @return : null
    '''
    # å»ºç«‹åŸå§‹å›¾åƒå„ç°åº¦çº§çš„ç°åº¦å€¼ä¸åƒç´ ä¸ªæ•°å¯¹åº”è¡¨
    histogram = {}
    for i in range(img.shape[0]):
        for j in range(img.shape[1]):
            k = img[i][j][0]
            if k in histogram:
                histogram[k] += 1
            else:
                histogram[k] = 1

    sorted_histogram = {}               # å»ºç«‹æ’å¥½åºçš„æ˜ å°„è¡¨
    sorted_list = sorted(histogram)     # æ ¹æ®ç°åº¦å€¼è¿›è¡Œä»ä½è‡³é«˜çš„æ’åº

    for j in range(len(sorted_list)):
        sorted_histogram[sorted_list[j]] = histogram[sorted_list[j]]

    return sorted_histogram
```

------

## ç›´æ–¹å›¾å‡è¡¡åŒ–å®æˆ˜

### ç°åº¦å›¾

ä¸‹æ–¹çš„ä¸¤ä¸ªä¾‹å­ä¸ºæˆ‘ä»¬å±•ç¤ºäº†ç›´æ–¹å›¾å‡è¡¡åŒ–çš„é­”åŠ›ï¼ŒåŸå›¾å’ŒåŸå›¾çš„ç›´æ–¹å›¾å¦‚ä¸‹ï¼Œä¹‹åæ˜¯ç›´æ–¹å›¾å‡è¡¡åŒ–åçš„å›¾åƒå’Œå¯¹åº”çš„ç›´æ–¹å›¾

#### ä¾‹ä¸€

**åŸå›¾**

<img src="../../../../Library/Application Support/typora-user-images/image-20191110001431995.png" alt="image-20191110001431995" style="zoom:25%;" />

**åŸå›¾çš„ç›´æ–¹å›¾**

<img src="../../../../Library/Application Support/typora-user-images/image-20191110001502685.png" alt="image-20191110001502685" style="zoom: 25%;" />

**ç›´æ–¹å›¾å‡è¡¡åŒ–**

<img src="../../../../Library/Application Support/typora-user-images/image-20191110001536378.png" alt="image-20191110001536378" style="zoom:25%;" />

**ç›´æ–¹å›¾å‡è¡¡åŒ–çš„ç›´æ–¹å›¾**

<img src="../../../../Library/Application Support/typora-user-images/image-20191110001556437.png" alt="image-20191110001556437" style="zoom:25%;" />

#### ä¾‹äºŒ

åŸå›¾ä¸­æˆ‘ä»¬åŸºæœ¬çœ‹ä¸åˆ°ä»»ä½•ä¿¡æ¯ï¼Œä½†æ˜¯ç®€å•çš„ç›´æ–¹å›¾å‡è¡¡åŒ–ä¹‹åå±…ç„¶æ˜¯ä¸€å¼ ä¿¡æ¯å¾ˆå¤šçš„å›¾åƒï¼ˆç¥å¥‡å§ï¼‰

**åŸå›¾**

<img src="../../../../Library/Application Support/typora-user-images/image-20191110001643522.png" alt="image-20191110001643522" style="zoom:25%;" />

**åŸå›¾çš„ç›´æ–¹å›¾**

<img src="../../../../Library/Application Support/typora-user-images/image-20191110001706306.png" alt="image-20191110001706306" style="zoom:25%;" />![image-20191110001722075](../../../../Library/Application Support/typora-user-images/image-20191110001722075.png)

**ç›´æ–¹å›¾å‡è¡¡åŒ–**

<img src="../../../../Library/Application Support/typora-user-images/image-20191110001722075.png" alt="image-20191110001722075" style="zoom:25%;" />

**ç›´æ–¹å›¾å‡è¡¡åŒ–çš„ç›´æ–¹å›¾**

<img src="../../../../Library/Application Support/typora-user-images/image-20191110001747444.png" alt="image-20191110001747444" style="zoom:25%;" />

åŸå›¾çš„ç›´æ–¹å›¾å¤§è‡´éƒ½é›†ä¸­åœ¨ä¸€ä¸ªçª„çš„èŒƒå›´å†…ï¼Œå› æ­¤å›¾åƒçš„å¯¹æ¯”åº¦è¾ƒä½ï¼Œæ˜¾å¾—ç°è’™è’™çš„ï¼Œæˆ–è€…å‡ ä¹éš¾ä»¥è§‚å¯Ÿï¼›ç›´æ–¹å›¾å‡è¡¡åŒ–å°†åƒç´ å‡åŒ€åŒ–ï¼Œå¯¹æ¯”åº¦å¢å¼ºï¼Œæé«˜å›¾åƒçš„è§†è§‰æ•ˆæœ

------

### RGBå›¾ç‰‡